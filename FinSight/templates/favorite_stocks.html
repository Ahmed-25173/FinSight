{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Favorite Stocks - FinSight</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { background-color: #0a0f1c; color: #eaecef; font-family: 'Inter', sans-serif; }
    .card-hover { transition: all 0.3s ease-in-out; }
    .card-hover:hover { transform: translateY(-6px); box-shadow: 0 12px 24px rgba(30,144,255,0.35); }
    table th, table td { text-align: center; padding: 0.75rem; }
    table th { background-color: #1e90ff; color: white; font-weight: 600; font-size: 0.875rem; }
    table tbody tr:hover { background-color: #0d1323; transition: all 0.2s; }
    .fav-button { background: transparent; border: none; cursor: pointer; font-size: 1.25rem; }
    .ticker { font-weight: 700; color: #e6f2ff; }
  </style>
</head>
<body class="bg-[#0a0f1c] text-gray-200 font-sans">

<nav class="fixed w-full z-50 top-0 bg-transparent flex justify-between items-center px-8 py-4 shadow-sm">
  <div class="text-3xl md:text-4xl font-extrabold text-[#1e90ff] tracking-wide">FinSight</div>
  <div class="flex items-center space-x-3">
    <a href="{% url 'home' %}" class="bg-[#0b5ed7] hover:bg-[#3c83f6] rounded-lg px-4 py-2 transition">Home</a>
    <a href="{% url 'viewPortfolio' %}" class="bg-[#0b5ed7] hover:bg-[#3c83f6] rounded-lg px-4 py-2 transition">Portfolio</a>
    <a href="{% url 'favoriteStocksPage' %}" class="bg-[#0b5ed7] hover:bg-[#3c83f6] rounded-lg px-4 py-2 transition">Favorite Stocks</a>
    <a href="{% url 'logout' %}" class="bg-[#0b5ed7] hover:bg-[#3c83f6] rounded-lg px-4 py-2 transition">Logout</a>
  </div>
</nav>

<main class="pt-28 px-6 md:px-12 space-y-8">
  <h1 class="text-3xl md:text-4xl font-extrabold text-[#1e90ff] mb-6">Favorite Stocks</h1>

  <section class="grid md:grid-cols-3 gap-6">
    <div class="card-hover bg-[#101a2b] rounded-xl p-6 shadow-md border border-[#1a2238]">
      <span class="text-gray-400 uppercase text-sm mb-2">Total Favorites</span>
      <div class="text-2xl font-bold">{{ favorites|length }}</div>
    </div>
    <div class="card-hover bg-[#101a2b] rounded-xl p-6 shadow-md border border-[#1a2238]">
      <span class="text-gray-400 uppercase text-sm mb-2">Total Value (owned)</span>
      <div class="text-2xl font-bold">${{ total_value }}</div>
    </div>
    <div class="card-hover bg-[#101a2b] rounded-xl p-6 shadow-md border border-[#1a2238]">
      <span class="text-gray-400 uppercase text-sm mb-2">Last Price Update</span>
      {% if last_cache_time %}
        <div class="text-lg font-medium">{{ last_cache_time|date:"M j, Y H:i" }}</div>
      {% else %}
        <div class="text-lg font-medium">N/A</div>
      {% endif %}
    </div>
  </section>

  <section class="bg-[#101a2b] rounded-xl p-6 shadow-lg border border-[#1a2238] overflow-x-auto">
    <h2 class="text-xl font-bold text-[#1e90ff] mb-4">Your Favorite Stocks</h2>

    {% if stock_data %}
    <table class="min-w-full table-auto border-collapse">
      <thead>
        <tr>
          <th>Symbol</th>
          <th>Name</th>
          <th>Current Price</th>
          <th>Owned Qty</th>
          <th>Value (owned)</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for s in stock_data %}
        <tr class="hover:bg-[#0d1323] transition-all">
          <td class="ticker">{{ s.symbol }}</td>
          <td>{{ s.name }}</td>
          <td>${{ s.current_price }}</td>
          <td>{{ s.owned_qty }}</td>
          <td>${{ s.value }}</td>
          <td>
            <form action="{% url 'removeFavoriteStock' %}" method="post" style="display:inline;">
              {% csrf_token %}
              <input type="hidden" name="symbol" value="{{ s.symbol }}">
              <button class="fav-button text-yellow-400">Remove ★</button>
            </form>
            <form action="{% url 'addFavoriteStock' %}" method="post" style="display:inline; margin-left:8px;">
              {% csrf_token %}
              <input type="hidden" name="symbol" value="{{ s.symbol }}">
              <input type="hidden" name="name" value="{{ s.name }}">
              <button class="fav-button text-gray-400">Add again ☆</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
      <p class="text-gray-400">You have not added any favorite stocks yet. Go to your Portfolio and click the star to add favorites.</p>
    {% endif %}
  </section>

</main>

<footer class="bg-gradient-to-r from-[#04070f] to-[#1a2238] text-gray-400 text-center py-6 text-sm border-t border-[#2c3550]">
  © 2025 FinSight. All rights reserved.
</footer>

</body>
</html>
